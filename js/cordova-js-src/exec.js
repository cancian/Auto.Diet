//////////////////
// CORDOVA EXEC //
//////////////////
// IOS //
/////////
if (/(iPhone|iPad|iPod)/i.test(navigator.userAgent)) {
	function massageArgsJsToNative(e){if(!e||"Array"!=utils.typeName(e))return e;var a=[];return e.forEach(function(e,r){"ArrayBuffer"==utils.typeName(e)?a.push({CDVType:"ArrayBuffer",data:base64.fromArrayBuffer(e)}):a.push(e)}),a}function massageMessageNativeToJs(e){if("ArrayBuffer"==e.CDVType){var a=function(e){for(var a=new Uint8Array(e.length),r=0;r<e.length;r++)a[r]=e.charCodeAt(r);return a.buffer},r=function(e){return a(atob(e))};e=r(e.data)}return e}function convertMessageToArgsNativeToJs(e){var a=[];return e&&e.hasOwnProperty("CDVType")?"MultiPart"==e.CDVType?e.messages.forEach(function(e){a.push(massageMessageNativeToJs(e))}):a.push(massageMessageNativeToJs(e)):a.push(e),a}function iOSExec(){var e,a,r,n,t,o=null;if("string"==typeof arguments[0])throw new Error("The old format of this exec call has been removed (deprecated since 2.1). Change to: cordova.exec(null, null, 'Service', 'action', [ arg1, arg2 ]);");e=arguments[0],a=arguments[1],r=arguments[2],n=arguments[3],t=arguments[4],o="INVALID",t=t||[],(e||a)&&(o=r+cordova.callbackId++,cordova.callbacks[o]={success:e,fail:a}),t=massageArgsJsToNative(t);var c=[o,r,n,t];commandQueue.push(JSON.stringify(c)),isInContextOfEvalJs||1!=commandQueue.length||pokeNative()}function proxyChanged(){var e=cordovaExec();return execProxy!==e&&iOSExec!==e}function handleBridgeChange(){if(proxyChanged()){for(var e=commandQueue.shift();e;){var a=JSON.parse(e),r=a[0],n=a[1],t=a[2],o=a[3],c=cordova.callbacks[r]||{};execProxy(c.success,c.fail,n,t,o),e=commandQueue.shift()}return!0}return!1}function pokeNative(){return document.body?(execIframe&&execIframe.contentWindow?execIframe.contentWindow.location="gap://ready":(execIframe=document.createElement("iframe"),execIframe.style.display="none",execIframe.src="gap://ready",document.body.appendChild(execIframe)),void(failSafeTimerId=setTimeout(function(){commandQueue.length&&(handleBridgeChange()||pokeNative())},50))):void setTimeout(pokeNative)}function cordovaExec(){var e=require("cordova/exec"),a="function"==typeof e.nativeFetchMessages&&"function"==typeof e.nativeEvalAndFetch&&"function"==typeof e.nativeCallback;return a&&execProxy!==e?e:iOSExec}function execProxy(){cordovaExec().apply(null,arguments)}var cordova=require("cordova"),utils=require("cordova/utils"),base64=require("cordova/base64"),execIframe,commandQueue=[],isInContextOfEvalJs=0,failSafeTimerId=0;iOSExec.nativeFetchMessages=function(){if(failSafeTimerId&&(clearTimeout(failSafeTimerId),failSafeTimerId=0),!commandQueue.length)return"";var e="["+commandQueue.join(",")+"]";return commandQueue.length=0,e},iOSExec.nativeCallback=function(e,a,r,n,t){return iOSExec.nativeEvalAndFetch(function(){function t(){cordova.callbackFromNative(e,o,a,c,n)}var o=0===a||1===a,c=convertMessageToArgsNativeToJs(r);setTimeout(t,0)})},iOSExec.nativeEvalAndFetch=function(e){isInContextOfEvalJs++;try{return e(),iOSExec.nativeFetchMessages()}finally{isInContextOfEvalJs--}},execProxy.nativeFetchMessages=function(){return cordovaExec().nativeFetchMessages.apply(null,arguments)},execProxy.nativeEvalAndFetch=function(){return cordovaExec().nativeEvalAndFetch.apply(null,arguments)},execProxy.nativeCallback=function(){return cordovaExec().nativeCallback.apply(null,arguments)},module.exports=execProxy;
/////////////
// ANDROID //
/////////////
} else if (/Android/i.test(navigator.userAgent)) {
	function androidExec(e,s,i,o,a){if(0>bridgeSecret)throw new Error("exec() called without bridgeSecret");void 0===jsToNativeBridgeMode&&androidExec.setJsToNativeBridgeMode(jsToNativeModes.JS_OBJECT);for(var r=0;r<a.length;r++)"ArrayBuffer"==utils.typeName(a[r])&&(a[r]=base64.fromArrayBuffer(a[r]));var n=i+cordova.callbackId++,d=JSON.stringify(a);(e||s)&&(cordova.callbacks[n]={success:e,fail:s});var t=nativeApiProvider.get().exec(bridgeSecret,i,o,n,d);jsToNativeBridgeMode==jsToNativeModes.JS_OBJECT&&"@Null arguments."===t?(androidExec.setJsToNativeBridgeMode(jsToNativeModes.PROMPT),androidExec(e,s,i,o,a),androidExec.setJsToNativeBridgeMode(jsToNativeModes.JS_OBJECT)):t&&(messagesFromNative.push(t),nextTick(processMessages))}function pollOnceFromOnlineEvent(){pollOnce(!0)}function pollOnce(e){if(!(0>bridgeSecret)){var s=nativeApiProvider.get().retrieveJsMessages(bridgeSecret,!!e);s&&(messagesFromNative.push(s),processMessages())}}function pollingTimerFunc(){pollEnabled&&(pollOnce(),setTimeout(pollingTimerFunc,50))}function hookOnlineApis(){function e(e){cordova.fireWindowEvent(e.type)}window.addEventListener("online",pollOnceFromOnlineEvent,!1),window.addEventListener("offline",pollOnceFromOnlineEvent,!1),cordova.addWindowEventHandler("online"),cordova.addWindowEventHandler("offline"),document.addEventListener("online",e,!1),document.addEventListener("offline",e,!1)}function buildPayload(e,s){var i=s.charAt(0);if("s"==i)e.push(s.slice(1));else if("t"==i)e.push(!0);else if("f"==i)e.push(!1);else if("N"==i)e.push(null);else if("n"==i)e.push(+s.slice(1));else if("A"==i){var o=s.slice(1);e.push(base64.toArrayBuffer(o))}else if("S"==i)e.push(window.atob(s.slice(1)));else if("M"==i)for(var a=s.slice(1);""!==a;){var r=a.indexOf(" "),n=+a.slice(0,r),d=a.substr(r+1,n);a=a.slice(r+n+1),buildPayload(e,d)}else e.push(JSON.parse(s))}function processMessage(message){var firstChar=message.charAt(0);if("J"==firstChar)eval(message.slice(1));else if("S"==firstChar||"F"==firstChar){var success="S"==firstChar,keepCallback="1"==message.charAt(1),spaceIdx=message.indexOf(" ",2),status=+message.slice(2,spaceIdx),nextSpaceIdx=message.indexOf(" ",spaceIdx+1),callbackId=message.slice(spaceIdx+1,nextSpaceIdx),payloadMessage=message.slice(nextSpaceIdx+1),payload=[];buildPayload(payload,payloadMessage),cordova.callbackFromNative(callbackId,success,status,payload,keepCallback)}else console.log("processMessage failed: invalid message: "+JSON.stringify(message))}function processMessages(){if(!isProcessing&&0!==messagesFromNative.length){isProcessing=!0;try{var e=popMessageFromQueue();if("*"==e&&0===messagesFromNative.length)return void nextTick(pollOnce);processMessage(e)}finally{isProcessing=!1,messagesFromNative.length>0&&nextTick(processMessages)}}}function popMessageFromQueue(){var e=messagesFromNative.shift();if("*"==e)return"*";var s=e.indexOf(" "),i=+e.slice(0,s),o=e.substr(s+1,i);return e=e.slice(s+i+1),e&&messagesFromNative.unshift(e),o}var cordova=require("cordova"),nativeApiProvider=require("cordova/android/nativeapiprovider"),utils=require("cordova/utils"),base64=require("cordova/base64"),channel=require("cordova/channel"),jsToNativeModes={PROMPT:0,JS_OBJECT:1},nativeToJsModes={POLLING:0,LOAD_URL:1,ONLINE_EVENT:2},jsToNativeBridgeMode,nativeToJsBridgeMode=nativeToJsModes.ONLINE_EVENT,pollEnabled=!1,bridgeSecret=-1,messagesFromNative=[],isProcessing=!1,resolvedPromise="undefined"==typeof Promise?null:Promise.resolve(),nextTick=resolvedPromise?function(e){resolvedPromise.then(e)}:function(e){setTimeout(e)};androidExec.init=function(){bridgeSecret=+prompt("","gap_init:"+nativeToJsBridgeMode),channel.onNativeReady.fire()},hookOnlineApis(),androidExec.jsToNativeModes=jsToNativeModes,androidExec.nativeToJsModes=nativeToJsModes,androidExec.setJsToNativeBridgeMode=function(e){e!=jsToNativeModes.JS_OBJECT||window._cordovaNative||(e=jsToNativeModes.PROMPT),nativeApiProvider.setPreferPrompt(e==jsToNativeModes.PROMPT),jsToNativeBridgeMode=e},androidExec.setNativeToJsBridgeMode=function(e){e!=nativeToJsBridgeMode&&(nativeToJsBridgeMode==nativeToJsModes.POLLING&&(pollEnabled=!1),nativeToJsBridgeMode=e,bridgeSecret>=0&&nativeApiProvider.get().setNativeToJsBridgeMode(bridgeSecret,e),e==nativeToJsModes.POLLING&&(pollEnabled=!0,setTimeout(pollingTimerFunc,1)))},module.exports=androidExec;
///////////////////
// WINDOWS PHONE //
///////////////////
} else if (/IEMobile/i.test(navigator.userAgent) && !/MSApp/i.test(navigator.userAgent)) {
	//
///////////
// MSAPP //
///////////
} else if (/MSApp/i.test(navigator.userAgent)) {
	//
///////////////////
// BLACKBERRY 10 //
///////////////////
} else if (/BB10/i.test(navigator.userAgent)) {
	//
////
} //
////

